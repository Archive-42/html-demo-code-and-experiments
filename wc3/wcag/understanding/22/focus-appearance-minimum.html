<!DOCTYPE html>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
   <meta charset="UTF-8"></meta>
   <title>Understanding Focus Visible</title>
   <link rel="stylesheet" type="text/css" href="../../css/editors.css" class="remove"></link>
</head>
<body>
   <h1>Understanding Focus Appearance (Minimum)</h1>
   
    <section id="status" class="advisement">
        <h2>Status</h2>
        <p>This understanding document is part of the <a href="https://w3c.github.io/wcag/guidelines/22/"><strong>draft</strong> WCAG 2.2 content</a>. It may change or be removed before the final WCAG 2.2 is published.</p>
    </section>


   <section class="remove">
   
        <h2>Focus Appearance (Minimum) Success Criterion text</h2>
        <blockquote>
            <p class="conformance-level">AA</p>
        
            <p>When <a>user interface components</a> receive keyboard focus, an area of the focus indicator meets the following:</p>
            <ul>
                <li><strong>Minimum area:</strong> The area is either:
                <ul>
                    <li>at least as large as the area of a 1 <a>CSS pixel</a> thick <a>perimeter</a> of the unfocused component, or</li>
                    <li>at least as large as the area of a 4 CSS pixel thick line along the shortest side of a <a>minimum bounding box</a> of the unfocused component, and no part of the area is thinner than 2 CSS pixels.</li>
                </ul></li>
                <li><strong>Contrast:</strong> The area has a contrast ratio of at least 3:1 between the colors when the component is focused and it is not focused.</li>
                <li><strong>Adjacent contrast:</strong> Where the area is adjacent to the component, it has a contrast ratio of at least 3:1 against the component or a thickness of at least 2 CSS pixels.</li>
            </ul>
            <p>Additionally, the item with focus is not entirely hidden by author-created content.</p>
            <p class="note">A keyboard focus indicator which has a pattern or gradient may have parts that do not meet the 3:1 contrast ratio for the change of contrast, as long as an area equal to the minimum does meet the contrast ratio.</p>
            <p class="note">If the component has a visible boundary smaller than the hit area, or the size of the component is not available, the minimum area can be taken from the visible boundary.</p>
            <p class="ednote">The working group is interested in feedback about the minimum area metric, and if there are unusual scenarios where visible indicators are caught by the wording.</p>
            <dl>
            <dt class="new"><dfn>Focus indicator</dfn></dt>
            <dd class="new">
	            pixels that are changed to visually indicate when a user interface component is in a focused state.                				
            </dd>
            <dt class="new"><dfn>Perimeter</dfn></dt>
            <dd class="new">
                continuous line forming the boundary of a shape not including shared pixels, or the minimum bounding box of a complex shape, whichever is shortest. For example, the perimeter calculation for a rectangle is 2<em>h</em>+2<em>w</em> -4, where <em>h</em> is the height and <em>w</em> is the width and the corners are not counted twice. The perimeter of a circle is 2ùúã<em>r</em>.
            </dd>
            <dt class="new"><dfn>minimum bounding box</dfn></dt>
            <dd class="new">
                the smallest enclosing box within which all the points of a shape lie. Where a component consists of disconnected parts, such as a link that wraps onto multiple lines, each part is considered to have its own bounding box.
            </dd>
            </dl>
        </blockquote>
     </section>
   
    <section id="intent">
        
        <h2>Intent of Focus Appearance (Minimum)</h2>


        <p>The purpose of this Success Criterion is to ensure a keyboard focus indicator is clearly visible and discernible. This criterion is closely related to <a href="https://www.w3.org/WAI/WCAG22/Understanding/focus-visible.html">2.4.7 Focus Visible</a> and <a href="https://www.w3.org/WAI/WCAG22/Understanding/non-text-contrast.html">1.4.11 Non-text Contrast</a>. Where Focus Visible merely requires a visible focus indicator, 2.4.11 defines a minimum level of visibility. Where Non-text Contrast requires a component to have adequate contrast against the background in each of its states, 2.4.11 requires sufficient contrast <em>between</em> the focused and unfocused states.</p>

        <p>For sighted people with mobility impairments who use a keyboard-like device (e.g., a switch, voice input), knowing the current point of focus is very important. Visible focus must also meet the needs of low-vision users, who may also be keyboard-only users.</p>
            
        <p>A keyboard focus indicator can take different forms; this Success Criterion sets a requirement to make it clearly distinguishable. For example, using a thick outline that contrasts with the background behind the component would pass this criterion.</p>

        <figure id="focus-indicator-strong">
            <img src="img/focus-indicators-passing.png" alt="Three example indicators, an outline separated from the button, an inner outline, and a thick outline." width="250" />
            <figcaption> Examples of outlines that would pass easily on a light background.</figcaption>
        </figure>
        <p>The minimum size requirement for each focus indicator shown above are:</p>
        <ul>
            <li>A 1 <a>CSS pixel</a> dark outline outside the button, separated from the button by 1 pixel;</li>
            <li>A 2-pixel thick light outline inside the button;</li>
            <li>A 2-pixel thick dark outline around the button.</li>
        </ul>

        <p><strong>Any outline that is at least 2px thick and contrasts with the non-focused state would pass this criterion</strong>. The detail in this document is for people who do not wish to use such an outline.</p>

        <p>The default focus indicators in some browsers can be difficult to see, such as a 1px dotted outline, or a blue indicator which happens to be on a blue background. It is generally best to either define a keyboard focus style which meets this criterion, or test the focus styles across the browsers that are relied upon for conformance.</p>

        <section id="keyboard-focus">
            <h3>Keyboard focus</h3>
            <p>The keyboard focus is the point of interaction for someone using a keyboard. For environments with a keyboard-operable interface, the keyboard focus can be moved around the interface in order to interact with different elements. Whichever element is being interacted with has focus.</p>

            <p>Some components have sub-components that can take focus, such as the menu items on a menu. The item considered to be focused is whichever is being interacted with. For example, if you tab to a menu and arrow down to a menu item, it is the menu item that is in focus; pressing Enter would activate the menu item.</p>

            <p>Some non-operable elements can take focus (such as a heading element that is the target of a skip link); however, it is only when the element with focus is operable by keyboard that this Success Criterion applies.</p>
        </section>

        <section id="change-of-color">
            <h3>Contrasting area</h3>


            <blockquote>
                <ul><li><strong>Contrasting area</strong>: There is an area of the focus indicator that has a contrast ratio of at least 3:1 between the colors in the focused and unfocused states. </li></ul>
            </blockquote>

            <p>The greater the change of contrast between states the easier it is for users to see it. Authors are encouraged to make the change of color contrast as great as possible.</p>

            <p>When a component changes to include a focus indicator, that change can be measured as a change of color contrast. For example, if a yellow outline is added to a button on a blue background, the change of color is from blue to yellow. This change can be measured whether the focus indicator is on the background around the component, or the background within the component.</p>
                    
                        <figure id="focus-indicator-innerline-2">
                <img src="img/focus-indicator-innerline.png" alt="Three dark blue buttons on a white background. The middle button has a yellow inner border." width="284" />
                <figcaption> Adding a yellow outline to a link is a change of color from blue to yellow. That change has a contrast ratio of 12:1.</figcaption>
            </figure>        

                    
            <p>Text and non-text contrast measures use adjacent colors; this Success Criterion measures the <em>change</em> in color between non-focused and focused states.</p>

            <figure id="focus-indicator-non-contrast">
                <img src="img/focus-indicator-non-contrast.png" alt="Three buttons with light background and dark border on a white background. The middle button has a light grey outline." width="250" />
                <figcaption> The second link has a light-grey (#ccc) focus outline which <strong>fails</strong> this Success Criterion because the change from white-background to light-grey outline does not meet 3:1.</figcaption>
            </figure>
            <p class="note">Color contrast measurements in WCAG are based on luminance (brightness) regardless of the hue.</p>

            <p>If a control receiving focus changes its background (fill color) to a color that contrasts less than 3:1 with the original background, that would not pass the change of contrast.</p>

            <figure id="focus-indicator-background">
                <img src="img/focus-indicator-background.png" alt="Three black buttons with a dark background. The middle button has a dark grey background." width="250" />
                <figcaption> The second link has a dark-grey (#555) which <strong>fails</strong> this Success Criterion because the change from black-background to dark-grey background does not meet 3:1.</figcaption>
            </figure>
            <p>If the background change is sufficient, it is a method of passing the criterion.</p>
            <figure id="focus-indicator-background-passing">
                <img src="img/focus-indicator-background-passing.png" alt="Three black buttons with a dark border and two have a dark background. The middle button has a white background." width="250" />
                <figcaption> The second link has a white background (#fff) which <strong>passes</strong> this Success Criterion because the change from black-background to white-background meets 3:1.</figcaption>
            </figure>

            <p>It is possible to use visual patterns such as strips switching places to disguise a change of focus indicator. This is not considered a visible indicator.</p>

        </section>
            
        
        <section id="size-of-indicator">
            <h3>Minimum area</h3>

            <blockquote>
                <ul>
                    <li>Minimum area: The contrasting area is at least as large as:
                        <ul>
                            <li><strong>Outline</strong>: the area of a 1 CSS pixel thick perimeter of the unfocused component, or</li>
                            <li><strong>Shape</strong>: the area of a 4 CSS pixel thick line along the shortest side of a minimum bounding box of the unfocused component, and no thinner than 2 CSS pixels.</li>
                        </ul>
                    </li>
                </ul>
            </blockquote>
            
            <p>The bigger the visible change when an item receives focus, the easier it is for someone to see. Authors are encouraged to make the change as significant as possible, for example, by designing a thick border around the element.</p>

            <p>The Success Criterion defines a minimum area using a calculation for perimeter, and a secondary minimum based on the shortest side of the control. It does not restrict where the indicators are placed, it is just providing two methods to calculate a minimum area.</p>

            <p>For the first calculation, the minimum area of the focus indicator must be at least as large as the area of a 1 CSS pixel thick perimeter (border) of the control in its unfocussed state. The indicator does not have to be a border, but the indicator's area must be at least as large. For example, if a control is a rectangle of 90px wide and 30px tall, the size of the outer border is 90 + 90 + 30 + 30 = 240 CSS pixels. You then must subtract the 4 corner pixels (which are counted twice, both horizontally and vertically), for a total minimum area of 236 CSS pixels.</p>

            <p class="note">A <a>CSS pixel</a> is what developers use in CSS declarations like ‚Äúwidth: 200px‚Äù, it is device-independent and not to be confused with device pixels which vary depending on the physical pixel density. <br />
                The rest of this document notates CSS pixels as "px".
            </p>

            <p>The following 3 examples use a 90px wide by 30px tall button, therefore the surface area requirement is 236px (240px minus corner 4 pixels). The middle button is focused in each example.</p>

            <figure id="focus-indicator-innerline">
                <img src="img/focus-indicator-innerline.png" alt="Three dark blue buttons on a white background. The middle button has a yellow inner border." width="284" />
                <figcaption> The inner outline is slightly smaller than the outer edge of the component (236px minus 2px on each side), but using a 2px thick indicator means it is well over the minimum requirement of 236px squared.</figcaption>
            </figure>

            <figure id="focus-indicator-underline">
                <img src="img/focus-indicator-underline.png" alt="Three dark blue buttons on a white background. The middle button has a thick yellow line under the text." width="284" />
                <figcaption> The thick (3px) yellow underline is almost as long as the longest edge, 80px multiplied by 3px exceeds the requirement of 236px squared.</figcaption>
            </figure>

            <p>If controls change size across different variations of a page (e.g., in a responsive design), it helps to use a proportionally sized indicator such as an outline or background change. In that way you can be sure of meeting the size requirement.</p>

            <p>The Success Criterion includes an alternative size measure of "at least as large as a 4 CSS pixels border along the shortest side, and no thinner than 2 CSS pixels". This is included to allow for smaller but thick indicators. For example, some controls might be of a fixed height but variable width, in which case this measure allows for a more consistent approach. Although the area is less than the primary measure, the minimum thickness helps to maintain the visibility.</p>

            <figure id="focus-indicator-shortside">
                <img src="img/focus-indicator-thick-short-side.png" alt="Two dark blue buttons on a white background. The left button has a very thick yellow block of color left of the text." width="284" />
                <figcaption> The yellow block on the left is along the short side, but very thick.</figcaption>
            </figure>

            <p>Typical focus indicators:</p>
            <ul>
                <li>A solid outline around the whole component would pass the size requirement;</li>
                <li>A 1 CSS pixel dotted outline around the whole component would <strong>not pass</strong> the size requirement, as it is roughly 50% of the surface area of a solid line.</li>
                <li>Changing the background within a control would pass the size requirement;</li>
                <li>A 1px wide vertical line (such as a blinking cursor) would <strong>not pass</strong> the size requirement, a text input would need a larger or separate focus indicator.</li>
            </ul>

            <p>If you need to use complex mathematics to work out if a focus indicator is large enough, it is probably a sign that you should use a larger and proportional indicator that will provide a more visible indicator.</p>
            
            <p>Where a focus indicator is defined in code as a certain size, e.g. 2px thickness, anti-aliasing can be ignored for the purposes of calculation. Dotted or dashed outlines have various levels of gaps depending on the browser, screen density, and thickness. For example, in most browsers a "dotted" line will have roughly half the number of pixels due to gaps. However, in some sizes or browsers it might be slightly less than half, so increasing the thickness may be required.</p>

            <section id="unusual-shapes">
                <h4>Unusual shapes and gradients</h4>
            
                <p>If you have an unusual shape (not rectangular), some mathematics may be required if the focus indicator is on the edge of the size requirement. For example, if the focusable control is a circle with a diameter of 100px, the circumference would be 314 pixels. A 1px (or greater) outline would meet the size criterion.</p>

                <figure id="focus-indicator-circle">
                    <img src="img/focus-indicator-circle.png" alt="Two orange circular buttons with an icon in the middle. The right hand circle has a dark outline around the whole circle to indicate focus" width="150" />
                    <figcaption> A circular button in the default state, and then with a focus indicator.</figcaption>
                </figure>

                <p>If a focus indicator is an irregular shape, such as a drop-shadow under a star icon, it helps if the contrasting area is quite large.</p>

                <figure id="focus-indicator-star-shadow">
                    <img src="img/focus-indicator-star-shadow.png" alt="Two yellow star symbols, the second has a dark drop-shadow." width="400" />
                    <figcaption> The default and focused states of a star component.</figcaption>
                </figure>

                <p>What is the contrasting area of the drop shadow? The quick method is:</p>
                <ul>
                    <li>Look at the size of the component, how long is it around the edges?</li>
                    <li>Look at the (contrasting) area of the focus indicator.</li>
                    <li>Mentally compare the focus indicator to the border of the component.</li>
                </ul>

                <p>If it is too close to call, you could extract the contrasting area of the focus indicator and evaluate the surface area.</p>

                <p>If a focus indicator has a gradient, the principle is to measure the contrast of the changed area, and ignore the change that does not meet 3:1.</p>
                <figure id="focus-indicator-box-shadow">
                    <img src="img/focus-indicator-box-shadow.png" alt="Three buttons, the middle with a heavy drop-shadow indicating focus." />
                    <figcaption> When a gradient is used on a focus indicator, the measure of surface area should only include the area that has changed enough to meet the 3:1 contrast ratio.</figcaption>
                </figure>
                <p>If you take some spot-checks on the gradient area and establish what area meets the contrast, it is straightforward to work out if that area is sufficient.</p>
                <figure id="focus-indicator-box-shadow-only">
                    <img src="img/focus-indicator-box-shadow-only.png" alt="The middle button with the drop-shadow included, but the subtle grey areas removed to only show the contrasting area." />
                    <figcaption> The focused button with the non-contrasting areas removed, showing that it is a thick indicator that meets the requirements.</figcaption>
                </figure>

                <p>If an inline link is broken over multiple lines, some methods of focus indicator are treated differently by browsers. Using CSS, an <code>outline</code> wraps each part of a wrapped link separately. A <code>border</code> will wrap the whole link as one perimeter. Each part of the link will pass or fail as though they were separate links. If a 1px CSS border is used rather than outline, the thickness would need to be increased to compensate for the missing sides as it is not a complete perimeter for each part of the link.</p>
                <figure id="focus-indicator-inline-link">
                    <img src="img/focus-inline-link.png" alt="A paragraph of text containing a link broken over two lines. The red focus indicator has a gap on the right of one part of the link, and on the left of the other part of the link." />
                    <figcaption> The wrapping affects the calculation since the element is not-contiguous and is missing one side of the perimeter.</figcaption>
                </figure>

                <figure id="focus-indicator-inline-link-outline">
                    <img src="img/focus-inline-link-outline.png" alt="A paragraph of text containing a link broken over two lines. The red focus indicator is a complete rectangle around each part of the link." />
                    <figcaption> The CSS outline property wraps each part of the link completely, so does not affect the calculation of indicator area.</figcaption>
                </figure>

                <p>Some designs have pages with a non-solid background image covering the whole (or part) of the page or make use of parallax scrolling effects which result in a near-infinite number of color combinations if a page is scrolled and/or changes are made to the viewport size.</p>
                <p>If the contrast of background colors that change are close enough to need to be tested for each combination then they would likely not meet the user need of people with low vision in certain scroll combinations and would likely fail in certain combinations as well. In these cases it would be an easy solution to use a double ring focus indicator or some other mechanism to indicate focus such as a solid box with a border to guarantee there is sufficient contrast across variations of background images or background gradients.</p>

                <p>Some pages contain very large editing regions, such as web implementations of word processors and code editors. Unlike a `textarea` element, which is a user interface component, these large editing regions do not typically meet the definition of <a href="https://w3c.github.io/wcag/guidelines/22/#dfn-user-interface-components">user interface components</a>; they are not "perceived by users as a single control for a distinct function." Providing focus indicators around such editing regions may still be beneficial to some; however, where the region is not perceived as a single control, it is not covered by this Success Criterion. The web page will still need to provide a insertion point (caret indicator) in such editing regions in order to meet the requirements of <a href="https://www.w3.org/WAI/WCAG22/Understanding/focus-visible.html">2.4.7 Focus Visible</a>.</p>

            </section>
        </section>

        <section id="Contrast-thickness">
            <h3>Adjacent contrast</h3>

            <blockquote>
                <ul>
                    <li><strong>Adjacent contrast</strong>: The contrasting area also has a contrast ratio of least 3:1 against adjacent colors in the focused component, or the contrasting area has a thickness of at least 2 CSS pixels. </li>
                </ul>
            </blockquote>

            <p>Where a control is a solid color, and you add a border or outline of a very similar color, it is difficult to perceive the change to the control.</p>

            <figure id="focus-indicator-thin-non-contrast">
                <img src="img/focus-indicator-thin-non-contrast.png" alt="Three dark buttons, the middle one appears very slightly larger due to a thin dark outline." width="255" />
                <figcaption> Adding a 1px dark outline around a dark button does not differentiate it. This example <strong>fails</strong> the Success Criterion.</figcaption>
            </figure>
                    
            <p>The requirement is to have an indicator that has a 3:1 contrast ratio with the adjacent colors of the component, or to be separated from the component, or to be at least 2px thick.</p>

            <figure id="focus-indicator-thick-non-contrast">
                <img src="img/focus-indicator-thick-non-contrast.png" alt="Three dark buttons, the middle one appears larger due to a thick dark outline." width="255" />
                <figcaption> Adding a 2px border around the button helps to differentiate which one is focused.</figcaption>
            </figure>

            <figure id="focus-indicator-outerline">
                <img src="img/focus-indicator-outerline.png" alt="Three dark buttons, the middle one has a outline slightly offset away from the component, so there is a gap between the component's background and the outline." width="250" />
                <figcaption> Adding an outline that is separated from the button helps to differentiate which one is focused.</figcaption>
            </figure>

            <p>If the focus indicator uses several colors, any color which does not interfere with identifying the indicator can be ignored for the purpose of measuring contrast ratio. For example, a 3D drop-shadow on a focus indicator is considered to be subsumed into the color closest in brightness (perceived luminance). If the size is uncertain, calculate the minimum size based on the area which meets the contrast change requirement.</p>

            <figure id="focus-indicator-extra-outline">
                <img src="img/focus-indicator-extra-outline.png" alt="Two dark blue buttons on a white background. The second one has a dark outline, then a light grey outline on the outside." width="250" />
                <figcaption> The light grey outline can be ignored, the 3px thick dark outline meets the size and change of contrast requirements.</figcaption>
            </figure>

        </section>
        <section id="unobscured">
            <h3>Not fully obscured</h3>

            <blockquote>
                <ul>
                    <li><strong>Not fully obscured</strong>: The item with focus is not entirely hidden by author-created content.</li>
                </ul>
            </blockquote>

            <p>Where other content can overlap with a focused item, the focused element should not be hidden. Typical types of content that can overlap focused items are sticky footers, sticky headers, or non-modal dialogues. As a user tabs through the page, these layers of content can obscure the focused item, including the focus indicator. If the interface is configurable so that the user can move toolbars and non-modal dialogs around, then only the initial positions of user-movable content would be considered for testing and conformance of the "Not fully obscured" bullet.</p>

            <p class="note">The criterion specifies the "focused item" in the 'Not fully obscured' bullet rather than the "focus indicator". The requirements for the indicator are set in the previous bullets; the last bullet applies to the item as a whole.</p>

        </section>
        <section id="relation-non-text-color-contrast">
            <h3>Relationship to Non-text Contrast</h3>
            <p>In combination with <a href="focus-visible">2.4.7 Focus Visible</a>,  <a href="non-text-contrast" class="sc">1.4.11 Non-text Contrast</a> requires that the visual focus indicator for a component must have sufficient contrast against the adjacent colors when the component is focused, except where the appearance of the component is determined by the user agent and not modified by the author.</p>
                
            <p>However, Non-text Contrast differs in what it assesses. Unlike the current Success Criterion, it does not require that the focus indicator has a change of contrast <em>between</em> the focused and non-focused states. Additionally, there is no size requirement and no exception for user-agent default indicators.</p>
            
            <figure id="focus-indicator-ntc-comparison1">
                <img src="img/focus-indicator-ntc-comparison1.png" alt="Three dark blue buttons, the center button also has a thin dark line around it." width="400" />
                <figcaption> A 1px dark outline around a dark button would pass 1.4.11 Non-text Contrast, but fails this success criterion.</figcaption>

           </figure>

        </section>


    </section>
    <section id="benefits">
      <h2>Benefits of Focus Visible</h2>
      
      <ul>
         <li>This Success Criterion helps anyone who relies on the keyboard to operate the page, by letting them visually determine the component on which keyboard operations will interact at any point in time.</li>
         <li>People with attention limitations, short term memory limitations, or limitations in executive processes benefit by being able to discover where the focus is located.</li>
      </ul>
      
   </section>
   
   <section id="examples">
      <h2>Examples of Focus Visible</h2>

      <ul>
         <li>When links receive focus, an outline is displayed around the link that contrasts with the background adjacent to the link.</li>
         <li>When buttons receive focus, an outline is displayed within the button (around the text) that contrasts with the button‚Äôs background.</li>
         <li>When text fields receive focus, an outline is displayed around the field, indicating that the input has focus.</li>  
         <li>When radio buttons receive focus, an outline is displayed around the control, indicating that the input has focus.</li>        
      </ul>
      
   </section>

   
   <section id="techniques">
      <h2>Techniques for Focus Appearance (Minimum)</h2>
      
      
      <section id="sufficient">
         <h3>Sufficient Techniques</h3>
         
         
         <ol>
            <li>
                <a href="https://www.w3.org/WAI/WCAG21/Techniques/general/G195" class="general">Using an author-supplied, highly visible focus indicator</a>
            </li>
            <li>
               <a href="../../techniques/css/C40">Creating a two-color focus indicator to ensure sufficient contrast</a>
            </li>
            <li>
            	<a href="../../techniques/css/C41">Creating a contrasting focus indicator inside the component</a>
            </li>
         </ol>
         
      </section>
      
      <section id="advisory">
         <h3>Additional Techniques (Advisory)</h3>
         
      </section>
      
      <section id="failure">
         <h3>Failures</h3>
         <ol>
            <li>
                @@@ Using a CSS border for inline text which can wrap
            </li>
         </ol>
      </section>
      
   </section>
   
</body>
</html>
