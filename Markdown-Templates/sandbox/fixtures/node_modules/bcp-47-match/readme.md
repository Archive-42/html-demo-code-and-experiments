bcp-47-match
============

[![Build](https://img.shields.io/travis/wooorm/bcp-47-match.svg)](https://travis-ci.org/wooorm/bcp-47-match) [![Coverage](https://img.shields.io/codecov/c/github/wooorm/bcp-47-match.svg)](https://codecov.io/github/wooorm/bcp-47-match) [![Downloads](https://img.shields.io/npm/dm/bcp-47-match.svg)](https://www.npmjs.com/package/bcp-47-match) [![Size](https://img.shields.io/bundlephobia/minzip/bcp-47-match.svg)](https://bundlephobia.com/result?p=bcp-47-match)

Match [BCP 47](https://tools.ietf.org/html/bcp47) language tags with “language ranges” per [RFC 4647](https://tools.ietf.org/html/rfc4647), as done by the `:lang()` pseudo-class in CSS, or the `Accept-Language` HTTP header.

Related to [`bcp-47`](https://github.com/wooorm/bcp-47).

Contents
--------

-   [Install](#install)
-   [Use](#use)
-   [API](#api)
    -   [`match.basicFilter(tags[, ranges])`](#matchbasicfiltertags-ranges)
    -   [`match.extendedFilter(tags[, ranges])`](#matchextendedfiltertags-ranges)
    -   [`match.lookup(tags, ranges)`](#matchlookuptags-ranges)
-   [License](#license)

Install
-------

[npm](https://docs.npmjs.com/cli/install):

    npm install bcp-47-match

Use
---

    var match = require('bcp-47-match')

    var basic = match.basicFilter
    var extended = match.extendedFilter
    var lookup = match.lookup

    var tags = ['en-GB', 'de-CH', 'en', 'de']

    console.log(basic(tags, '*')) // => [ 'en-GB', 'de-CH', 'en', 'de' ]
    console.log(basic(tags, 'en')) // => [ 'en-GB', 'en' ]
    console.log(basic(tags, 'en-GB')) // => [ 'en-GB' ]
    console.log(basic(tags, ['en-GB', 'en'])) // => [ 'en-GB', 'en' ]
    console.log(basic(tags, 'jp')) // => []

    console.log(extended(tags, '*')) // => [ 'en-GB', 'de-CH', 'en', 'de' ]
    console.log(extended(tags, 'en')) // => [ 'en-GB', 'en' ]
    console.log(extended(tags, 'en-GB')) // => [ 'en-GB' ]
    console.log(extended(tags, '*-GB')) // => [ 'en-GB' ]
    console.log(extended(tags, ['en-GB', 'en'])) // => [ 'en-GB', 'en' ]
    console.log(extended(tags, 'jp')) // => []

    console.log(lookup(tags, 'en')) // => 'en'
    console.log(lookup(tags, 'en-GB')) // => 'en-GB'
    console.log(lookup(tags, ['en-GB', 'en'])) // => 'en-GB'
    console.log(lookup(tags, ['en', 'en-GB'])) // => 'en'
    console.log(lookup(tags, 'jp')) // => undefined

API
---

### `match.basicFilter(tags[, ranges])`

> [See Basic Filtering spec](https://tools.ietf.org/html/rfc4647#section-3.3.1)

Match language tags to a list of simple ranges. Searches for matches between the first range and all tags, and continues with further ranges. Returns a list of matching tags in the order they matched.

View matching table

<table><thead><tr class="header"><th>Basic Filter</th><th>*</th><th>de</th><th>de-CH</th><th>de-DE</th><th>de-*-DE</th><th>*-CH</th></tr></thead><tbody><tr class="odd"><td>de</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>de-CH</td><td>✔︎</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td></tr><tr class="odd"><td>de-CH-1996</td><td>✔︎</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td></tr><tr class="even"><td>de-DE</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td></td><td></td></tr><tr class="odd"><td>de-DE-1996</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td></td><td></td></tr><tr class="even"><td>de-DE-x-goethe</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td></td><td></td></tr><tr class="odd"><td>de-Deva</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>de-Deva-DE</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="odd"><td>de-Latf-DE</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>de-Latn-DE</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="odd"><td>de-Latn-DE-1996</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>de-x-DE</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="odd"><td>en</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>en-GB</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr><tr class="odd"><td>zh</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>zh-Hans</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr><tr class="odd"><td>zh-Hant</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table>

###### Parameters

-   `tags` (`string` or `Array.<string>`) — List of BCP-47 tags
-   `ranges` (`string` or `Array.<string>`) — List of RFC 4647 [basic ranges](https://tools.ietf.org/html/rfc4647#section-2.1) (aka, matching `/^(\*|[a-z]{1,8}(-[a-z0-9]{1,8})*)$/i`)

###### Returns

`Array.<string>` — Possibly empty list of matching tags in the order they matched.

### `match.extendedFilter(tags[, ranges])`

> [See Extended Filtering spec](https://tools.ietf.org/html/rfc4647#section-3.3.2)

Match language tags to a list of extended ranges. Searches for matches between the first range and all tags, and continues with further ranges.

View matching table

<table><thead><tr class="header"><th>Extended Filter</th><th>*</th><th>de</th><th>de-CH</th><th>de-DE</th><th>de-*-DE</th><th>*-CH</th></tr></thead><tbody><tr class="odd"><td>de</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>de-CH</td><td>✔︎</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td>✔︎</td></tr><tr class="odd"><td>de-CH-1996</td><td>✔︎</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td>✔︎</td></tr><tr class="even"><td>de-DE</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td>✔︎</td><td></td></tr><tr class="odd"><td>de-DE-1996</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td>✔︎</td><td></td></tr><tr class="even"><td>de-DE-x-goethe</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td>✔︎</td><td></td></tr><tr class="odd"><td>de-Deva</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>de-Deva-DE</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td>✔︎</td><td></td></tr><tr class="odd"><td>de-Latf-DE</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td>✔︎</td><td></td></tr><tr class="even"><td>de-Latn-DE</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td>✔︎</td><td></td></tr><tr class="odd"><td>de-Latn-DE-1996</td><td>✔︎</td><td>✔︎</td><td></td><td>✔︎</td><td>✔︎</td><td></td></tr><tr class="even"><td>de-x-DE</td><td>✔︎</td><td>✔︎</td><td></td><td></td><td></td><td></td></tr><tr class="odd"><td>en</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>en-GB</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr><tr class="odd"><td>zh</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr><tr class="even"><td>zh-Hans</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr><tr class="odd"><td>zh-Hant</td><td>✔︎</td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table>

###### Parameters

-   `tags` (`string` or `Array.<string>`) — List of BCP-47 tags
-   `ranges` (`string` or `Array.<string>`) — List of RFC 4647 [extended ranges](https://tools.ietf.org/html/rfc4647#section-2.2) (aka, matching `/^(\*|[a-z]{1,8})(-(\*|[a-z0-9]{1,8}))*$/i`)

###### Returns

`Array.<string>` — Possibly empty list of matching tags in the order they matched.

### `match.lookup(tags, ranges)`

> [See Lookup spec](https://tools.ietf.org/html/rfc4647#section-3.4)

Find the best language tag that matches a list of ranges. Searches for a match between the first range and all tags, and continues with further ranges. Returns the first match, if any.

View matching table

<table><thead><tr class="header"><th>Lookup</th><th>*</th><th>de</th><th>de-CH</th><th>de-DE</th><th>de-*-DE</th><th>*-CH</th></tr></thead><tbody><tr class="odd"><td>de</td><td></td><td>✔︎︎</td><td>✔︎︎</td><td>✔︎</td><td>✔︎</td><td>✔︎</td></tr><tr class="even"><td>de-CH</td><td></td><td></td><td>✔︎</td><td></td><td></td><td>✔︎</td></tr><tr class="odd"><td>de-CH-1996</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="even"><td>de-DE</td><td></td><td></td><td></td><td>✔︎</td><td></td><td>✔︎</td></tr><tr class="odd"><td>de-DE-1996</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="even"><td>de-DE-x-goethe</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="odd"><td>de-Deva</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="even"><td>de-Deva-DE</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="odd"><td>de-Latf-DE</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="even"><td>de-Latn-DE</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="odd"><td>de-Latn-DE-1996</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="even"><td>de-x-DE</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="odd"><td>en</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="even"><td>en-GB</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="odd"><td>zh</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="even"><td>zh-Hans</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr><tr class="odd"><td>zh-Hant</td><td></td><td></td><td></td><td></td><td></td><td>✔︎</td></tr></tbody></table>

###### Parameters

-   `tags` (`string` or `Array.<string>`) — List of BCP-47 tags
-   `ranges` (`string` or `Array.<string>`) — List of RFC 4647 basic ranges (but `*` is ignored)

###### Returns

`string?` — The first matching tag in `tags`, or `undefined` otherwise.

License
-------

[MIT](license) © [Titus Wormer](https://wooorm.com)
